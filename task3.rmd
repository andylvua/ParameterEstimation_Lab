## Problem 3.
#### The expected value of the exponential distribution E (λ) is 1/λ, so that a good point estimate of the parameter θ := 1/λ is the sample mean x. Confidence interval for θ can be formed in several different ways

```{r}
library(crayon)
```

```{r}
id <- 1

n <- 10000
m <- 1000
alphas <- c(0.1, 0.05, 0.01)
theta <- id / 10
lambda <- 1 / theta
datas <- matrix(rexp(n * m, rate = lambda), nrow = n)
```

### A. Verify that the confidence intervals of level 1 − a constructed via (1)–(4) above contain the parameter θ = 1/λ approx. 100(1 − α)% of times.

#### (1) Approximating using chi-squared distribution.

$$\mathcal{E}(\lambda) \sim \mathcal{G}(1,\ 1/{\lambda})$$
$$\sum^{iid}\mathcal{G}(1,\ 1/{\lambda}) \sim \mathcal{G}(n,\ 1/{\lambda})\sim 0.5\chi^2_{2n}$$

A two-sided $(1-\alpha)100$ confidence interval for $\lambda$ then is:
$$\left[\frac{\chi^2(2n,\ \alpha/2)}{2n\overline{x}},\ \frac{\chi^2(2n,\ 1-\alpha/2)}{2n\overline{x}}\right]$$
$\chi^2(v,\ p)$ is the p'th quantile of chi-square distribution with v degrees of dreedom

```{r}
alpha <- 0.1
contains <- 0
for (i in 1:m) {
    sample_mean <- mean(datas[, i])
    left <- qchisq(alpha / 2, df = 2 * n) / (2 * sample_mean * n)
    right <- qchisq(1 - alpha / 2, df = 2 * n) / (2 * sample_mean * n)
    if (left <= lambda & lambda <= right) {
        contains <- contains + 1
    }
}
print(contains / m)
```

#### (2) Approximating using normal approximation.
$$ \mu=\theta\ \ \ \ \sigma^2 = \theta^2 $$
$$ X\sim\mathcal{N}(\theta,\ \theta^2)$$
$$\overline{X}=\frac{1}{n}\sum^{iid}X_i \sim \mathcal{N}(\theta,\ \theta^2/n)$$

```{r}
mu <- theta
var <- theta^2
```

